CREATE TABLE SALESPEOPLE(
	SNUM VARCHAR2(3) PRIMARY KEY,
	SNAME VARCHAR2(15),
	CITY VARCHAR2(20),
	COMM NUMBER(4));



CREATE TABLE CUSTOMER(
	CNUM VARCHAR2(5) PRIMARY KEY,
	CNAME VARCHAR2(15),
	CITY VARCHAR2(20),
	RATING NUMBER(2),
	SNUM VARCHAR2(3) REFERENCES SALESPEOPLE (SNUM));



CREATE TABLE ORDERS(
	ONUM VARCHAR2(5) PRIMARY KEY,
	AMT NUMBER(4),
	ODATE DATE,
	CNUM VARCHAR2(5) REFERENCES CUSTOMER(CNUM),
	SNUM VARCHAR2(3) REFERENCES SALESPEOPLE(SNUM));



a))
CREATE VIEW VW1 AS (
	SELECT * FROM CUSTOMER
	WHERE RATING = (SELECT MAX(RATING) FROM CUSTOMER)
);



b))
CREATE VIEW VW2 AS(
	SELECT COUNT(SNUM) NO_OF_SALESPEOPLE, CITY
	FROM SALESPEOPLE GROUP BY CITY
);



c))
CREATE VIEW VW3 AS(
	SELECT S.SNUM, AVG(O.AMT) "AVERAGE ORDERS", SUM(O.AMT) "TOTAL ORDERS"
	FROM SALESPEOPLE S
	LEFT JOIN ORDERS O
	ON S.SNUM = O.SNUM
	GROUP BY S.SNUM
);



d))
CREATE VIEW VW4 AS(
	SELECT SNUM, COUNT(CNUM) NO_OF_CUSTOMERS FROM CUSTOMER
	GROUP BY SNUM
	HAVING COUNT(CNUM) > 1
);



3)
CREATE VIEW SALESPEOPLE_CUSTOMER_ORDERS AS(
	SELECT S.SNAME, C.CNAME, O.ONUM
	FROM SALESPEOPLE S, CUSTOMER C, ORDERS O
	WHERE S.SNUM = O.SNUM AND C.CNUM = O.CNUM
);



4)
CREATE VIEW VW5 AS
SELECT SNUM, COMM
FROM SALESPEOPLE
WHERE COMM BETWEEN 1000 AND 2000
WITH CHECK OPTION;

SQL> INSERT INTO VIEW4 VALUES('S16', 2000);

1 row created.

SQL> SELECT * FROM VIEW4;

SNUM        COMM
----- ----------
S16       2000